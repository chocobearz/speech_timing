const fs = require('fs');
const sdk = require("microsoft-cognitiveservices-speech-sdk");
const directory = "C:\\Users\\ptut0\\Documents\\speech_timing\\evaluation\\"

  
/*
  Arguments:
  template: if template use template mode
*/

let template = `<speak 
        xmlns="http://www.w3.org/2001/10/synthesis" 
        xmlns:mstts="http://www.w3.org/2001/mstts" 
        xmlns:emo="http://www.w3.org/2009/10/emotionml" 
        version="1.0" xml:lang="en-US"
        >
        <voice name="en-US-JennyNeural">
          <mstts:express-as style="Neutral" >
            TEXT
          </mstts:express-as>
        </voice>
        </speak>`

function synthesizeSpeech(ssml, audioFile) {
    const speechConfig = sdk.SpeechConfig.fromSubscription("bcded59e70d7427489c33925841a874d", "canadacentral");
    const audioConfig = sdk.AudioConfig.fromAudioFileOutput(audioFile);
    const synthesizer = new sdk.SpeechSynthesizer(speechConfig, audioConfig);
  
    synthesizer.speakSsmlAsync(
        ssml,
        result => {
            if (result.reason == sdk.ResultReason.SynthesizingAudioCompleted) {
                console.log("synthesis finished.");
                console.log(JSON.stringify(result));
            } else {
              console.error("Speech synthesis canceled, " + result.errorDetails);
            }
  
            synthesizer.close();
            synthesizer = null;
        },
        error => {
          console.trace("err - " + err);
          synthesizer.close();
          synthesizer = null;
        });
        console.log("Now synthesizing to: " + audioFile);
}

// fill in the script
(async ()=>{
  const ilona_random = ['medium', 'x-slow', 'medium', 'x-fast', 'x-slow', 'slow', 'x-slow', 'slow', 'x-fast', 'medium', 'slow', 'fast', 'x-slow', 'x-fast', 'medium', 'slow', 'x-slow', 'x-slow', 'fast', 'x-fast', 'fast', 'fast', 'x-slow', 'x-slow'];
  const ilona_ted = ['x-slow', 'fast', 'fast', 'x-fast', 'x-fast', 'medium', 'slow', 'x-slow', 'medium', 'x-fast', 'x-slow', 'slow', 'slow', 'x-fast', 'fast', 'slow', 'x-fast', 'slow', 'fast', 'fast', 'x-slow', 'medium', 'fast', 'fast'];
  const ilona_common = ['medium', 'medium', 'medium', 'medium', 'medium', 'medium', 'medium', 'medium', 'medium', 'medium', 'medium', 'medium', 'medium', 'medium', 'medium', 'medium', 'medium', 'medium', 'medium', 'medium', 'medium', 'medium', 'medium', 'medium'];
  const ilona_chatgpt = ['medium', 'fast', 'slow', 'fast', 'x-fast', 'fast', 'x-slow', 'x-fast', 'x-fast', 'x-slow', 'fast', 'x-slow', 'fast', 'x-fast', 'x-slow', 'medium', 'medium', 'x-fast', 'x-slow', 'medium', 'medium', 'x-fast', 'slow', 'x-slow'];
  const ted_lengths = ['slow', 'slow', 'x-fast', 'slow', 'medium', 'x-slow', 'fast', 'x-fast', 'x-slow', 'x-slow', 'fast', 'fast', 'slow', 'x-fast', 'medium', 'x-fast', 'slow', 'x-fast', 'x-fast', 'x-fast', 'medium', 'slow', 'x-slow', 'fast', 'x-fast', 'slow', 'slow', 'fast', 'x-fast', 'x-slow', 'fast', 'x-fast', 'fast', 'x-fast', 'fast', 'medium', 'fast', 'medium', 'fast', 'x-slow', 'medium', 'slow', 'x-slow', 'x-fast', 'medium', 'x-fast', 'medium', 'x-slow', 'fast', 'x-slow', 'slow', 'slow', 'x-fast', 'x-slow', 'medium', 'fast', 'x-fast', 'fast', 'fast', 'medium', 'x-fast', 'medium', 'slow', 'fast', 'x-fast', 'fast', 'x-slow', 'medium', 'slow', 'x-slow', 'fast', 'x-fast', 'slow', 'medium', 'medium', 'x-fast', 'slow', 'x-fast', 'x-fast', 'x-slow', 'x-fast', 'fast', 'x-slow', 'fast', 'x-fast', 'fast', 'medium', 'x-fast', 'x-fast', 'x-slow', 'medium', 'medium', 'medium', 'x-fast', 'medium', 'x-slow', 'x-fast', 'medium', 'x-slow', 'medium', 'slow', 'fast', 'x-fast', 'medium', 'x-slow', 'fast', 'medium', 'x-slow', 'fast', 'slow', 'x-fast', 'slow', 'x-fast', 'x-fast', 'slow', 'fast', 'medium', 'x-slow', 'x-fast', 'fast', 'fast', 'slow', 'x-fast', 'slow', 'x-slow', 'x-slow', 'medium', 'x-fast', 'x-fast', 'slow', 'medium', 'medium', 'fast', 'x-slow', 'medium', 'medium', 'fast', 'medium', 'x-slow', 'x-fast', 'slow', 'x-fast', 'x-fast', 'x-fast', 'slow', 'slow', 'medium', 'fast', 'medium', 'x-slow', 'medium', 'slow', 'medium', 'x-fast', 'medium', 'x-fast', 'slow', 'x-fast', 'x-fast', 'fast', 'x-slow', 'medium', 'fast', 'x-fast', 'medium', 'x-fast', 'x-fast', 'slow', 'medium', 'slow', 'medium', 'slow', 'x-fast', 'x-fast', 'x-slow', 'fast', 'fast', 'medium', 'slow', 'x-fast', 'slow', 'medium', 'x-slow', 'medium', 'medium', 'x-fast', 'x-fast', 'x-slow', 'medium', 'slow', 'slow', 'fast', 'x-slow', 'fast', 'x-slow', 'medium', 'fast', 'x-slow', 'fast', 'x-fast', 'fast', 'x-fast', 'fast', 'x-fast', 'medium', 'slow', 'x-fast', 'x-fast', 'x-slow', 'medium', 'x-slow', 'x-slow', 'medium', 'slow', 'x-fast', 'medium', 'slow', 'slow', 'x-fast', 'medium', 'x-slow', 'fast', 'fast', 'x-slow', 'fast', 'x-fast', 'x-slow', 'x-slow', 'x-fast', 'fast', 'x-slow', 'medium', 'x-fast', 'x-slow', 'slow', 'medium', 'medium', 'x-slow', 'x-fast', 'slow', 'x-fast', 'slow', 'medium', 'fast', 'fast', 'medium', 'medium', 'x-fast', 'x-slow', 'fast', 'fast', 'x-slow', 'x-slow', 'x-fast', 'x-slow', 'medium', 'fast', 'fast', 'x-fast', 'fast', 'medium', 'slow', 'x-fast', 'x-slow', 'slow', 'slow', 'slow', 'slow', 'medium', 'medium', 'medium', 'x-fast', 'slow', 'x-slow', 'x-slow', 'x-slow', 'medium', 'medium', 'medium', 'slow', 'medium', 'medium', 'fast', 'x-fast', 'x-fast', 'x-slow', 'x-slow', 'fast', 'x-slow', 'fast', 'slow', 'x-slow', 'medium', 'medium', 'fast', 'medium', 'x-slow', 'slow', 'medium', 'x-fast', 'x-fast', 'x-slow', 'x-slow', 'fast', 'x-fast', 'slow', 'slow', 'slow', 'fast', 'fast', 'medium', 'x-slow', 'x-slow', 'x-fast', 'x-fast', 'x-slow', 'fast', 'fast', 'x-fast', 'slow', 'slow', 'x-slow', 'medium', 'x-slow', 'x-slow', 'x-slow', 'x-slow', 'x-slow', 'fast', 'fast', 'slow', 'medium', 'x-fast', 'x-fast', 'x-slow', 'fast', 'slow', 'slow', 'slow', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'slow', 'slow', 'slow', 'slow', 'slow', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'medium', 'medium', 'medium', 'medium', 'slow', 'x-fast', 'slow', 'slow', 'slow'];
  const chatgpt_lengths = ['slow', 'slow', 'fast', 'slow', 'slow', 'slow', 'x-fast', 'x-fast', 'medium', 'fast', 'medium', 'medium', 'medium', 'x-slow', 'slow', 'x-slow', 'fast', 'medium', 'fast', 'x-fast', 'slow', 'slow', 'fast', 'fast', 'slow', 'x-fast', 'x-fast', 'x-fast', 'medium', 'x-fast', 'x-fast', 'medium', 'fast', 'x-slow', 'fast', 'medium', 'fast', 'fast', 'slow', 'slow', 'x-slow', 'x-fast', 'medium', 'slow', 'medium', 'medium', 'medium', 'slow', 'slow', 'x-fast', 'slow', 'slow', 'medium', 'x-fast', 'slow', 'slow', 'fast', 'slow', 'slow', 'x-slow', 'fast', 'x-fast', 'x-slow', 'slow', 'medium', 'slow', 'slow', 'medium', 'medium', 'slow', 'medium', 'x-slow', 'x-fast', 'slow', 'x-fast', 'slow', 'fast', 'x-fast', 'x-slow', 'fast', 'fast', 'fast', 'fast', 'x-slow', 'fast', 'x-fast', 'x-slow', 'x-fast', 'x-slow', 'x-fast', 'x-fast', 'slow', 'medium', 'slow', 'slow', 'slow', 'medium', 'slow', 'fast', 'x-fast', 'fast', 'x-slow', 'x-slow', 'x-slow', 'x-slow', 'slow', 'fast', 'x-fast', 'slow', 'x-fast', 'x-fast', 'medium', 'x-fast', 'x-slow', 'fast', 'fast', 'x-slow', 'fast', 'x-slow', 'slow', 'x-fast', 'slow', 'slow', 'slow', 'fast', 'medium', 'slow', 'fast', 'fast', 'slow', 'medium', 'fast', 'medium', 'x-fast', 'x-slow', 'x-fast', 'slow', 'slow', 'fast', 'fast', 'slow', 'slow', 'medium', 'medium', 'x-slow', 'x-slow', 'slow', 'x-fast', 'slow', 'slow', 'x-fast', 'x-fast', 'medium', 'medium', 'medium', 'x-fast', 'fast', 'x-fast', 'fast', 'x-fast', 'fast', 'medium', 'fast', 'medium', 'fast', 'medium', 'x-slow', 'x-fast', 'x-slow', 'x-fast', 'x-slow', 'x-fast', 'x-fast', 'fast', 'x-slow', 'fast', 'x-slow', 'fast', 'x-fast', 'fast', 'x-fast', 'x-fast', 'x-fast', 'fast', 'medium', 'medium', 'fast', 'fast', 'fast', 'fast', 'fast', 'x-slow', 'x-slow', 'fast', 'medium', 'fast', 'fast', 'x-fast', 'fast', 'x-fast', 'x-slow', 'fast', 'x-slow', 'x-slow', 'x-fast', 'x-slow', 'x-slow', 'fast', 'x-slow', 'slow', 'x-slow', 'slow', 'x-slow', 'x-slow', 'medium', 'medium', 'x-slow', 'fast', 'x-fast', 'x-slow', 'x-slow', 'x-fast', 'x-slow', 'slow', 'x-slow', 'x-slow', 'x-slow', 'slow', 'fast', 'slow', 'x-slow', 'x-fast', 'x-slow', 'slow', 'x-slow', 'x-fast', 'slow', 'slow', 'slow', 'slow', 'medium', 'fast', 'slow', 'x-slow', 'slow', 'x-fast', 'x-slow', 'slow', 'slow', 'slow', 'x-fast', 'x-slow', 'fast', 'x-slow', 'x-slow', 'x-slow', 'x-slow', 'x-slow', 'slow', 'x-slow', 'slow', 'medium', 'x-slow', 'x-slow', 'x-slow', 'slow', 'medium', 'slow', 'slow', 'x-fast', 'fast', 'x-slow', 'fast', 'x-fast', 'x-fast', 'medium', 'medium', 'x-fast', 'slow', 'x-slow', 'fast', 'slow', 'fast', 'x-fast', 'x-fast', 'slow', 'x-slow', 'x-fast', 'x-slow', 'slow', 'fast', 'fast', 'fast', 'fast', 'medium', 'x-fast', 'x-fast', 'medium', 'medium', 'x-slow', 'medium', 'fast', 'x-slow', 'x-fast', 'fast', 'medium', 'fast', 'fast', 'fast', 'slow', 'fast', 'slow', 'x-slow', 'medium', 'medium', 'medium', 'medium', 'medium', 'fast', 'x-fast', 'x-fast', 'fast', 'fast', 'x-fast', 'fast', 'fast', 'x-fast', 'x-slow', 'x-slow', 'slow', 'x-slow', 'medium', 'slow', 'medium', 'fast', 'fast', 'fast', 'x-fast', 'x-slow', 'slow', 'slow', 'slow', 'slow', 'slow', 'slow', 'slow', 'x-slow', 'fast', 'medium', 'x-slow', 'slow', 'slow', 'slow', 'slow', 'slow', 'slow', 'slow', 'slow', 'slow', 'slow', 'slow', 'slow', 'x-slow', 'slow', 'slow'];
  const discrete_lengths = ['slow', 'medium', 'medium', 'slow', 'fast', 'slow', 'x-fast', 'x-fast', 'slow', 'fast', 'slow', 'fast', 'fast', 'fast', 'x-slow', 'medium', 'medium', 'fast', 'slow', 'x-fast', 'medium', 'medium', 'x-slow', 'x-fast', 'fast', 'x-fast', 'medium', 'x-fast', 'x-fast', 'medium', 'x-fast', 'x-fast', 'fast', 'x-fast', 'medium', 'fast', 'slow', 'x-slow', 'fast', 'slow', 'x-slow', 'x-slow', 'x-slow', 'x-fast', 'x-slow', 'fast', 'medium', 'fast', 'fast', 'slow', 'x-slow', 'slow', 'x-fast', 'x-slow', 'fast', 'x-fast', 'x-fast', 'medium', 'x-fast', 'slow', 'x-fast', 'medium', 'x-slow', 'fast', 'x-fast', 'medium', 'x-slow', 'fast', 'x-fast', 'slow', 'x-fast', 'x-fast', 'medium', 'medium', 'medium', 'x-fast', 'x-slow', 'fast', 'medium', 'slow', 'x-fast', 'medium', 'x-slow', 'fast', 'x-fast', 'fast', 'medium', 'fast', 'fast', 'x-slow', 'medium', 'slow', 'x-slow', 'x-fast', 'slow', 'x-slow', 'x-fast', 'slow', 'medium', 'slow', 'fast', 'fast', 'x-fast', 'medium', 'x-slow', 'fast', 'slow', 'slow', 'fast', 'slow', 'x-fast', 'slow', 'fast', 'x-fast', 'slow', 'slow', 'slow', 'x-slow', 'fast', 'fast', 'x-fast', 'slow', 'medium', 'x-fast', 'x-fast', 'x-slow', 'x-slow', 'medium', 'medium', 'x-slow', 'x-slow', 'x-slow', 'fast', 'x-slow', 'slow', 'x-slow', 'slow', 'fast', 'slow', 'x-fast', 'x-slow', 'medium', 'slow', 'x-fast', 'slow', 'x-slow', 'slow', 'medium', 'medium', 'medium', 'fast', 'x-slow', 'medium', 'x-fast', 'medium', 'medium', 'slow', 'fast', 'x-fast', 'fast', 'slow', 'medium', 'x-fast', 'x-fast', 'slow', 'fast', 'medium', 'slow', 'medium', 'slow', 'slow', 'x-slow', 'x-fast', 'x-fast', 'x-slow', 'medium', 'x-fast', 'fast', 'slow', 'fast', 'slow', 'x-slow', 'slow', 'x-fast', 'fast', 'x-fast', 'slow', 'x-slow', 'x-fast', 'medium', 'medium', 'medium', 'x-slow', 'fast', 'x-slow', 'fast', 'x-slow', 'x-slow', 'fast', 'slow', 'fast', 'x-fast', 'medium', 'x-fast', 'fast', 'medium', 'x-fast', 'x-fast', 'x-slow', 'medium', 'x-slow', 'medium', 'medium', 'x-fast', 'x-fast', 'medium', 'x-slow', 'x-slow', 'medium', 'slow', 'x-slow', 'x-fast', 'fast', 'x-slow', 'x-fast', 'medium', 'slow', 'x-slow', 'x-fast', 'x-fast', 'x-slow', 'fast', 'x-fast', 'slow', 'x-slow', 'medium', 'fast', 'slow', 'fast', 'medium', 'x-fast', 'medium', 'x-fast', 'fast', 'medium', 'fast', 'slow', 'fast', 'x-slow', 'fast', 'x-fast', 'x-slow', 'slow', 'x-fast', 'x-slow', 'medium', 'x-slow', 'medium', 'x-fast', 'slow', 'slow', 'slow', 'fast', 'x-slow', 'slow', 'slow', 'fast', 'slow', 'x-fast', 'medium', 'x-slow', 'fast', 'x-slow', 'medium', 'x-slow', 'x-fast', 'x-slow', 'slow', 'medium', 'medium', 'fast', 'medium', 'fast', 'fast', 'x-fast', 'x-slow', 'x-slow', 'fast', 'x-slow', 'x-fast', 'x-slow', 'x-slow', 'slow', 'slow', 'slow', 'fast', 'medium', 'x-slow', 'medium', 'fast', 'fast', 'slow', 'x-slow', 'slow', 'medium', 'medium', 'slow', 'x-fast', 'x-fast', 'x-fast', 'medium', 'fast', 'x-slow', 'medium', 'x-fast', 'x-slow', 'medium', 'fast', 'medium', 'x-fast', 'slow', 'slow', 'x-slow', 'medium', 'slow', 'x-slow', 'medium', 'x-slow', 'medium', 'medium', 'x-slow', 'slow', 'x-fast', 'fast', 'slow', 'x-fast', 'slow', 'fast', 'medium', 'x-fast', 'slow', 'x-fast', 'fast', 'x-fast', 'fast', 'slow', 'x-slow', 'medium', 'x-fast', 'x-slow', 'x-fast', 'x-fast', 'slow', 'slow', 'fast', 'slow', 'fast', 'fast', 'x-slow', 'slow', 'x-slow', 'medium', 'medium', 'medium', 'x-slow'];
  const random_lengths = ['medium', 'x-slow', 'medium', 'x-fast', 'x-slow', 'slow', 'x-slow', 'slow', 'x-fast', 'medium', 'slow', 'fast', 'x-slow', 'x-fast', 'medium', 'slow', 'x-slow', 'x-slow', 'fast', 'x-fast', 'fast', 'fast', 'x-slow', 'x-slow', 'slow', 'x-fast', 'x-slow', 'slow', 'slow', 'x-slow', 'medium', 'medium', 'medium', 'slow', 'x-slow', 'x-slow', 'fast', 'medium', 'slow', 'fast', 'medium', 'medium', 'x-slow', 'fast', 'fast', 'x-fast', 'fast', 'medium', 'fast', 'x-slow', 'x-fast', 'medium', 'fast', 'x-fast', 'x-slow', 'fast', 'slow', 'slow', 'medium', 'x-slow', 'slow', 'medium', 'medium', 'fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'slow', 'fast', 'x-fast', 'slow', 'medium', 'slow', 'x-slow', 'fast', 'medium', 'fast', 'x-fast', 'fast', 'medium', 'x-slow', 'x-fast', 'fast', 'x-slow', 'x-fast', 'medium', 'slow', 'x-fast', 'medium', 'x-fast', 'x-slow', 'x-fast', 'fast', 'x-slow', 'fast', 'x-slow', 'medium', 'fast', 'x-slow', 'x-slow', 'medium', 'x-slow', 'x-fast', 'fast', 'fast', 'fast', 'fast', 'x-fast', 'slow', 'fast', 'fast', 'fast', 'x-slow', 'slow', 'medium', 'x-slow', 'x-slow', 'fast', 'x-slow', 'slow', 'slow', 'medium', 'x-slow', 'slow', 'x-fast', 'x-slow', 'x-slow', 'x-fast', 'medium', 'medium', 'medium', 'slow', 'fast', 'x-fast', 'slow', 'x-slow', 'slow', 'x-fast', 'slow', 'medium', 'x-slow', 'slow', 'x-slow', 'slow', 'x-slow', 'x-slow', 'x-slow', 'x-slow', 'x-fast', 'medium', 'x-fast', 'x-slow', 'fast', 'fast', 'fast', 'x-slow', 'slow', 'x-slow', 'slow', 'fast', 'slow', 'medium', 'medium', 'slow', 'slow', 'x-fast', 'medium', 'x-fast', 'x-slow', 'fast', 'medium', 'x-fast', 'fast', 'fast', 'medium', 'medium', 'fast', 'x-fast', 'slow', 'medium', 'slow', 'x-slow', 'x-fast', 'medium', 'slow', 'fast', 'slow', 'fast', 'x-fast', 'medium', 'fast', 'medium', 'slow', 'fast', 'x-slow', 'slow', 'x-slow', 'x-slow', 'x-fast', 'slow', 'medium', 'slow', 'fast', 'x-slow', 'slow', 'fast', 'slow', 'medium', 'slow', 'fast', 'x-fast', 'x-slow', 'medium', 'slow', 'slow', 'fast', 'medium', 'medium', 'x-slow', 'fast', 'slow', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'medium', 'medium', 'slow', 'slow', 'medium', 'slow', 'x-fast', 'slow', 'fast', 'fast', 'medium', 'x-fast', 'x-slow', 'slow', 'x-fast', 'fast', 'x-fast', 'slow', 'slow', 'x-slow', 'slow', 'x-slow', 'slow', 'fast', 'x-slow', 'x-slow', 'x-fast', 'medium', 'fast', 'medium', 'slow', 'fast', 'fast', 'slow', 'fast', 'slow', 'x-slow', 'x-fast', 'medium', 'x-fast', 'slow', 'x-slow', 'x-slow', 'slow', 'medium', 'medium', 'slow', 'x-fast', 'x-fast', 'x-slow', 'medium', 'x-slow', 'fast', 'slow', 'x-slow', 'x-fast', 'x-slow', 'x-fast', 'x-fast', 'x-slow', 'medium', 'slow', 'fast', 'x-slow', 'x-slow', 'x-fast', 'slow', 'slow', 'medium', 'x-fast', 'fast', 'slow', 'slow', 'fast', 'fast', 'x-fast', 'slow', 'x-fast', 'fast', 'medium', 'fast', 'x-fast', 'x-slow', 'x-slow', 'medium', 'slow', 'x-slow', 'medium', 'fast', 'x-slow', 'fast', 'fast', 'x-slow', 'fast', 'fast', 'x-fast', 'medium', 'fast', 'x-fast', 'x-slow', 'fast', 'fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'medium', 'fast', 'fast', 'x-slow', 'fast', 'x-fast', 'slow', 'x-fast', 'x-fast', 'medium', 'fast', 'slow', 'medium', 'slow', 'x-fast', 'medium', 'x-slow', 'fast', 'x-slow', 'x-slow', 'x-slow', 'slow', 'slow', 'slow', 'slow', 'slow', 'x-slow', 'x-slow', 'fast', 'x-slow', 'medium', 'fast', 'medium'];
  const most_common_lengths = ['x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast', 'x-fast']
  try {
    //const files = await fs.promises.readdir(directory);
    //for( const file of files ) {
      //const script = await fs.promises.readFile(`${directory}${file}`, 'utf8');
      const prosodyTemplate = "<prosody rate=\"RATE0\"> WORD </prosody>";
      const script = "Thank you for coming to my TED talk about the most perfect girl in the world, the love of my life, Miss Ilona Flowers.".split(" ");
      const allProsodyElements = [];
      for (const idx in script) {
        const rateReplaced = prosodyTemplate.replace('RATE0', ilona_chatgpt[idx]);
        const wordReplaced = rateReplaced.replace('WORD', script[idx]);
        allProsodyElements.push('            ' + wordReplaced);
      }
      //const ssml = template.replace(`TEXT`, script)
      const ssml = template.replace(`TEXT`, allProsodyElements.join('\n'));
      console.log(ssml);
      //const filename = file.replace(`.txt`, '')
      const audioDirectory = directory.replace(`txt`, `audio`)
      const out_file = `${audioDirectory}ilona_chatgpt.wav`
      //generate audio
      synthesizeSpeech(ssml, out_file)
      //}
  }
  catch( e ) {
    console.error( "We've thrown! Whoops!", e );
  }
})();
